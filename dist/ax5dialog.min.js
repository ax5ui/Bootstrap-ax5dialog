"use strict";!function(i,t){var e=ax5.util,n=function(){var i,n=this;t&&t.call(this),this.activeDialog=null,this.config={clickEventName:"click",theme:"default",width:300,title:"",msg:"",lang:{ok:"ok",cancel:"cancel"},animateTime:250},i=this.config,i.id="ax5-dialog-"+ax5.getGuid(),this.init=function(){this.onStateChanged=i.onStateChanged},this.alert=function(t,a){return e.isString(t)&&(t={title:i.title,msg:t}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","alert")),this):(n.dialogConfig={},jQuery.extend(!0,n.dialogConfig,i),jQuery.extend(!0,n.dialogConfig,t),t=n.dialogConfig,t.dialogType="alert","undefined"==typeof t.btns&&(t.btns={ok:{label:i.lang.ok,theme:t.theme}}),this.open(t,a),this)},this.confirm=function(t,a){return e.isString(t)&&(t={title:i.title,msg:t}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","confirm")),this):(n.dialogConfig={},jQuery.extend(!0,n.dialogConfig,i),jQuery.extend(!0,n.dialogConfig,t),t=n.dialogConfig,t.dialogType="confirm",t.theme=t.theme||i.theme||"","undefined"==typeof t.btns&&(t.btns={ok:{label:i.lang.ok,theme:t.theme},cancel:{label:i.lang.cancel}}),this.open(t,a),this)},this.prompt=function(t,a){return e.isString(t)&&(t={title:i.title,msg:t}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","prompt")),this):(n.dialogConfig={},jQuery.extend(!0,n.dialogConfig,i),jQuery.extend(!0,n.dialogConfig,t),t=n.dialogConfig,t.dialogType="prompt",t.theme=t.theme||i.theme||"","undefined"==typeof t.input&&(t.input={value:{label:""}}),"undefined"==typeof t.btns&&(t.btns={ok:{label:i.lang.ok,theme:t.theme},cancel:{label:i.lang.cancel}}),this.open(t,a),this)},this.getContent=function(t,n){var a=[];return a.push('<div id="'+t+'" data-ax5-ui="dialog" class="ax5-ui-dialog '+n.theme+'">'),a.push('<div class="ax-dialog-heading">'),a.push(n.title||i.title||""),a.push("</div>"),a.push('<div class="ax-dialog-body">'),a.push('<div class="ax-dialog-msg">'),a.push((n.msg||i.msg||"").replace(/\n/g,"<br/>")),a.push("</div>"),n.input&&(a.push('<div class="ax-dialog-prompt">'),e.each(n.input,function(i,t){a.push('<div class="form-group">'),this.label&&a.push("    <label>"+this.label.replace(/\n/g,"<br/>")+"</label>"),a.push('    <input type="'+(this.type||"text")+'" placeholder="'+(this.placeholder||"")+' " class="form-control '+(this.theme||"")+'" data-dialog-prompt="'+i+'" style="width:100%;" value="'+(this.value||"")+'" />'),this.help&&a.push('    <p class="help-block">'+this.help.replace(/\n/g,"<br/>")+"</p>"),a.push("</div>")}),a.push("</div>")),a.push('<div class="ax-dialog-buttons">'),a.push('<div class="ax-button-wrap">'),e.each(n.btns,function(i,t){a.push('<button type="button" data-dialog-btn="'+i+'" class="btn btn-'+(this.theme||"default")+'">'+this.label+"</button>")}),a.push("</div>"),a.push("</div>"),a.push("</div>"),a.push("</div>"),a.join("")},this.open=function(t,e){var n,a,o={};if(t.id=t.id||i.id,a={width:t.width},jQuery(document.body).append(this.getContent(t.id,t)),this.activeDialog=jQuery("#"+t.id),this.activeDialog.css({width:a.width}),t.height=a.height=this.activeDialog.height(),"undefined"==typeof t.position||"center"===t.position){var l=window.innerWidth,s=window.innerHeight;o.top=s/2-a.height/2,o.left=l/2-a.width/2}else o.left=t.position.left||0,o.top=t.position.top||0;return this.activeDialog.css(o),"prompt"===t.dialogType?this.activeDialog.find("[data-dialog-prompt]").get(0).focus():this.activeDialog.find("[data-dialog-btn]").get(0).focus(),this.activeDialog.find("[data-dialog-btn]").on(i.clickEventName,function(i){this.btnOnClick(i||window.event,t,e)}.bind(this)),jQuery(window).bind("keydown.ax5dialog",function(i){this.onKeyup(i||window.event,t,e)}.bind(this)),jQuery(window).bind("resize.ax5dialog",function(i){this.align(i||window.event)}.bind(this)),n={self:this,state:"open"},t&&t.onStateChanged?t.onStateChanged.call(n,n):this.onStateChanged&&this.onStateChanged.call(n,n),this},this.align=function(i){if(!this.activeDialog)return this;var t=n.dialogConfig,e={width:t.width,height:t.height};return"undefined"==typeof t.position||"center"===t.position?(e.top=window.innerHeight/2-e.height/2,e.left=window.innerWidth/2-e.width/2):(e.left=t.position.left||0,e.top=t.position.top||0),this.activeDialog.css(e),this},this.btnOnClick=function(i,t,n,a,o){if(i.srcElement&&(i.target=i.srcElement),a=e.findParentNode(i.target,function(i){return i.getAttribute("data-dialog-btn")?!0:void 0})){o=a.getAttribute("data-dialog-btn");var l={self:this,key:o,value:t.btns[o],dialogId:t.id,btnTarget:a};if("prompt"===t.dialogType){var s=null;for(var d in t.input)if(l[d]=this.activeDialog.find("[data-dialog-prompt="+d+"]").val(),""==l[d]||null==l[d]){s=d;break}}if(t.btns[o].onClick)t.btns[o].onClick.call(l,o);else if("alert"===t.dialogType)n&&n.call(l,o),this.close();else if("confirm"===t.dialogType)n&&n.call(l,o),this.close();else if("prompt"===t.dialogType){if("ok"===o&&s)return this.activeDialog.find('[data-dialog-prompt="'+s+'"]').get(0).focus(),!1;n&&n.call(l,o),this.close()}}},this.onKeyup=function(i,t,e,n,a){if(i.keyCode==ax5.info.eventKeys.ESC&&this.close(),"prompt"===t.dialogType&&i.keyCode==ax5.info.eventKeys.RETURN){var o={self:this,key:a,value:t.btns[a],dialogId:t.id,btnTarget:n},l=null;for(var s in t.input)if(o[s]=this.activeDialog.find("[data-dialog-prompt="+s+"]").val(),""==o[s]||null==o[s]){l=s;break}if(l)return!1;e&&e.call(o,a),this.close()}},this.close=function(t,e){return this.activeDialog&&(t=n.dialogConfig,this.activeDialog.addClass("destroy"),jQuery(window).unbind("keydown.ax5dialog"),jQuery(window).unbind("resize.ax5dialog"),setTimeout(function(){this.activeDialog.remove(),this.activeDialog=null,e={self:this,state:"close"},t&&t.onStateChanged?t.onStateChanged.call(e,e):this.onStateChanged&&this.onStateChanged.call(e,e)}.bind(this),i.animateTime)),this},this.main=function(){arguments&&e.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};i.dialog=function(){return e.isFunction(t)&&(n.prototype=new t),n}()}(ax5.ui,ax5.ui.root);